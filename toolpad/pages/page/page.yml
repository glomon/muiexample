# yaml-language-server: $schema=https://raw.githubusercontent.com/mui/mui-toolpad/v0.1.50/docs/schemas/v1/definitions.json#properties/Page

apiVersion: v1
kind: page
spec:
  title: PETROL Test Page
  alias:
    - afzL2D9
  content:
    - component: DataGrid
      name: dataGrid
      props:
        rows:
          $$jsExpression: dogQuery.data
        columns:
          - field: "0"
            type: string
          - field: "1"
            type: json
        loading: false
        height: 432
        hideToolbar: true
        density: compact
    - component: Paper
      name: paper
      props:
        elevation: 10
      children:
        - component: PageRow
          name: pageRow
          props:
            justifyContent: start
          children:
            - component: Image
              name: image
              layout:
                horizontalAlign: start
                verticalAlign: start
              props:
                src:
                  $$jsExpression: imgQuery.data.message
                fit: cover
            - component: Text
              name: link
              layout:
                columnSize: 1
                horizontalAlign: end
                verticalAlign: end
              props:
                mode: link
                value: Link do slike
                href:
                  $$jsExpression: imgQuery.data.message
                openInNewTab: true
                loading: false
  displayName: PETROL Test Page
  display: shell
  queries:
    - name: dogQuery
      mode: query
      query:
        kind: rest
        url: https://dog.ceo/api/breeds/list/all
        headers: []
        method: GET
        transform: return Object.entries(data.message);
        transformEnabled: true
        searchParams: []
    - name: imgQuery
      mode: query
      query:
        kind: rest
        url:
          $$jsExpression: "`https://dog.ceo/api/breed/${parameters.breed}/images/random`"
        headers: []
        method: GET
        searchParams: []
        transform: "`https://dog.ceo/api/breed/${parameters.breed}/images/random`"
        transformEnabled: false
      parameters:
        - name: breed
          value:
            $$jsExpression: dataGrid.selection?.[0] ?? 'akita'
